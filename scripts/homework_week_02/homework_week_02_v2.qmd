---
title: "Homework Week 2 v2"
format: html
---

:::question
1. From the Howell1 dataset, consider only the people younger than 13 years old. Estimate the causal association between age and weight. Assume that age influences weight through two paths. First, age influences height, and height influences weight. Second, age directly influences weight through age-related changes in muscle growth and body proportions.
:::

Data preparation
```{r}
rm(list = ls())
library(rethinking)
data("Howell1")
d <- Howell1[Howell1$age < 13,]
```

Exploratory data analysis
```{r}
library(ggplot2)

ggplot(mapping = aes(x = d$age, y = d$weight)) +
  geom_point()
```

Simulate data
```{r}
sim_W <- function(A, cH = 0, bAH = 2, cW = 1, bHW = 1, bAW = 1){
  n <- 100
  H <- rnorm(n, cH + bAH * A)
  W <- rnorm(n, cW + bHW * H + bAW * A)
  data.frame(A, H, W)
}

dat_sim <- sim_W(runif(n, 0, 13))

ggplot(mapping = aes(x = dat_sim$A, y = dat_sim$W)) +
  geom_point()
```

Create linear regression
```{r}
Abar <- mean(d$age)
Hbar <- mean(d$height)

m <- quap(
  alist(
    W ~ dnorm(mu, sigma),
    mu <- a1 + b11 * (H - Hbar) + b12 * (A - Abar),
    H <- a2 + b21 * (A - Abar),
    a1 ~ dnorm(5, 1)
    b11 ~ dnorm()
  )
)
```

